<!DOCTYPE html>
<html>
    <head>
        <title>I was bored</title>
        <link rel="icon" href="icon.png">
        <link rel="stylesheet" href="typingprogram.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap">
    </head>
    <body>
        <div class="header">
            <h2>World's worst typing program</h2>
        </div>

        <div class="input">
            <p>Input your text:</p>
            <input id="message" type="text"></input>
            <button onclick="myfunc()">Run</button>
        </div>
        <div class="stuff">
            <p id="input2">This is your message</p>
            <p id="output"></p>
            <p id="tryfor"></p>
            <p id="attempt"></p>
            <p id="text"></p>
            <p id="nComplete"></p>

        </div>

        <script>
            function sleep(ms) {
                return new Promise(
                    resolve => setTimeout(resolve, ms)
                );
            }
        </script>
        
        <script>
            async function myfunc() {
                var charsheet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()-=_+,.:;'\" ";
                var i = 0;
                var m = 0;
                var n;
                var nComplete = 0;

                var input = document.getElementById('message').value;
                try {
                    if (input == "") throw "Hello, World!";
                }
                catch(empty) {
                    input = empty;
                }
                document.getElementById('input2').innerHTML = input;

                while (i < input.length) {
                    break; //coming soon
                }

                while (i < input.length) {
                    await sleep(10);
                    document.getElementById('tryfor').innerHTML = "Trying for \"" + input[i] + "\"";
                    document.getElementById('attempt').innerHTML = "Attempt #" + n;

                    var char = Math.floor(Math.random() * charsheet.length);
                    var select = charsheet.slice(char, (char + 1));
                    document.getElementById('text').innerHTML = select;

                    if (select == input[i]) {
                        if (typeof m === 'number') {
                            m = select;
                            n += 1;
                            document.getElementById('output').innerHTML = m;
                            n = 0;
                            nComplete += 1;
                        } else {
                            m += select;
                            n += 1;
                            document.getElementById('output').innerHTML = m;
                            n = 0;
                            nComplete += 1;
                        }
                        i += 1;
                        continue;
                    } else {
                        n += 1;
                        nComplete += 1;
                    }
                }
                document.getElementById('nComplete').innerHTML = nComplete + " tries to complete"; 
            }
        </script>
    </body>
</html>
